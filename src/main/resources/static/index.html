<!doctype html>
<html lang="de">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Mein Freundebuch</title>
    <style>
        :root{
          --bg:#e9eef5; --paper:#fffdf8; --ink:#1a1a1a; --muted:#6b7280;
          --leather1:#111827; --leather2:#1f2937; --accent:#f59e0b; /* gold */
          --ribbon:#dc2626; --elastic:#0ea5e9;
        }
        *{box-sizing:border-box}
        body{margin:0;background:var(--bg);color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif}

        header{padding:18px 16px;text-align:center}
        header h1{margin:0;font-size:20px;letter-spacing:.3px}

        .stage{display:flex;flex-direction:column;align-items:center;gap:14px;max-width:920px;margin:0 auto 36px;padding:0 12px}
        .book{position:relative;width:min(840px,95vw);height:clamp(420px,65vh,620px);perspective:1800px;user-select:none}

        /* ‚Äî‚Äî‚Äî COVER (Titelblatt) ‚Äî‚Äî‚Äî */
        .cover{
          position:absolute;inset:0;border-radius:16px;overflow:hidden;color:#fff;
          display:flex;align-items:center;justify-content:center;text-align:center;
          box-shadow:0 16px 40px rgba(0,0,0,.18), 0 2px 0 rgba(0,0,0,.25) inset;
          background:
            radial-gradient(1200px 600px at 80% -20%, rgba(255,255,255,.12) 0%, rgba(255,255,255,0) 60%),
            linear-gradient(135deg,var(--leather1),var(--leather2));
          isolation:isolate;
          z-index: 2000;
        }
        .cover::before{
          content:"";position:absolute;inset:0;mix-blend-mode:overlay;opacity:.25;pointer-events:none;
          background:
            radial-gradient(3px 3px at 12px 12px, rgba(255,255,255,.06) 0 40%, transparent 41%) 0 0/36px 36px,
            radial-gradient(3px 3px at 24px 24px, rgba(0,0,0,.2) 0 40%, transparent 41%) 0 0/36px 36px;
        }
        .spine{
          position:absolute;left:0;top:0;bottom:0;width:42px;background:
            linear-gradient(90deg,rgba(255,255,255,.08),rgba(255,255,255,0)),
            linear-gradient(180deg,#0c1426,#0a1020 35%,#0a0f1e);
          box-shadow:inset -6px 0 16px rgba(0,0,0,.35);
        }
        .elastic{
          position:absolute;right:64px;top:-12px;bottom:-12px;width:10px;background:
            linear-gradient(180deg,rgba(255,255,255,.15),rgba(255,255,255,0)), var(--elastic);
          border-radius:12px;box-shadow:inset 0 0 0 2px rgba(0,0,0,.1), 0 6px 18px rgba(0,0,0,.25);
          transform:rotate(-1deg);
        }
        .ribbon{
          position:absolute;bottom:-26px;left:86px;width:18px;height:60px;background:var(--ribbon);
          clip-path:polygon(0 0,100% 0,100% 80%,50% 100%,0 80%);filter:drop-shadow(0 8px 10px rgba(0,0,0,.25));
        }
        .gilt-frame{
          position:absolute;inset:22px;border-radius:14px;padding:28px;text-align:center;
          background:
            linear-gradient(165deg,rgba(255,255,255,.08),rgba(255,255,255,0)),
            radial-gradient(1000px 400px at 80% 0%, rgba(255,255,255,.08), transparent 60%);
          box-shadow:
            inset 0 0 0 2px rgba(255,255,255,.08),
            inset 0 0 1px 1px rgba(0,0,0,.45),
            inset 0 0 0 6px rgba(255,255,255,.04);
        }
        .foil{
          font-size:42px;letter-spacing:.4px;margin:0;
          background:linear-gradient(120deg,#fff 15%, #ffe59a 30%, #f6c453 45%, #fff2b2 60%, #d9a441 75%, #fff 90%);
          -webkit-background-clip:text;background-clip:text;color:transparent;
          text-shadow:0 1px 0 rgba(0,0,0,.2), 0 8px 28px rgba(0,0,0,.35);
        }
        .subtitle{margin:6px 0 0;color:#d1d5db;font-weight:500}
        .chip{
          display:inline-block;margin-top:10px;padding:6px 10px;border-radius:999px;font-size:12px;font-weight:700;letter-spacing:.3px;
          background:rgba(255,255,255,.12);border:1px solid rgba(255,255,255,.25);color:#fff
        }
        .stickers{position:absolute;inset:0;pointer-events:none;opacity:.95}
        .sticker{position:absolute;filter:drop-shadow(0 6px 14px rgba(0,0,0,.25))}
        .sticker svg{display:block}
        .sticker.heart{top:52px;right:64px;transform:rotate(8deg)}
        .sticker.star{bottom:56px;left:54px;transform:rotate(-10deg)}
        .sticker.pencil{top:86px;left:96px;transform:rotate(-18deg)}

        /* ‚Äî‚Äî‚Äî SEITEN ‚Äî‚Äî‚Äî */
        .page{
          position:absolute;inset:10px;background:var(--paper);border-radius:10px;box-shadow:0 18px 36px rgba(0,0,0,.12);
          padding:24px 26px;transform-origin:left center;transform:rotateY(0deg);
          transition:transform .7s cubic-bezier(.2,.7,.1,1), box-shadow .7s;backface-visibility:hidden;
          background-image:
            linear-gradient(to right, rgba(0,0,0,.06), rgba(0,0,0,0) 40%),
            repeating-linear-gradient(#0000, #0000 17px, rgba(0,0,0,.04) 18px, #0000 19px);
          overflow:hidden;
          z-index: 1;
        }
        .page:not(.active){pointer-events:none}
        .page.flipped{transform:rotateY(-180deg);box-shadow:0 10px 24px rgba(0,0,0,.06)}
        .kicker{color:var(--muted);font-size:12px;letter-spacing:.4px;text-transform:uppercase}
        .title{margin:.2rem 0 1rem;font-size:22px}
        .grid{display:grid;grid-template-columns:1fr 1fr;gap:10px 18px}
        .label{font-size:12px;color:var(--muted)}
        .value{font-weight:600}
        .footer{position:absolute;left:0;right:0;bottom:12px;color:var(--muted);font-size:12px;text-align:center}

        .back{
          position:absolute;inset:0;background:linear-gradient(135deg,#1f2937,#111827);border-radius:16px;color:#d1d5db;
          display:flex;align-items:center;justify-content:center;box-shadow:0 16px 40px rgba(0,0,0,.18);transform:translateZ(-1px);
        }

        .controls{display:flex;gap:8px;align-items:center;justify-content:center}
        .btn{border:0;border-radius:999px;padding:10px 14px;background:#111827;color:#fff;box-shadow:0 6px 18px rgba(0,0,0,.15);cursor:pointer;font-weight:600}
        .btn[disabled]{opacity:.45;cursor:not-allowed}
        .hint{font-size:12px;color:var(--muted)}

        .hotspot{position:absolute;top:0;bottom:0;width:25%;z-index:5;cursor:pointer}
        .hotspot.left{left:0}
        .hotspot.right{right:0}
        @media (max-width:700px){.grid{grid-template-columns:1fr}.hotspot{width:35%}}
    </style>
</head>
<body>
<header><h1>Mein Freundebuch</h1></header>

<div class="stage">
    <div class="book" id="book">
        <!-- TITELBLATT / COVER -->
        <div class="cover" id="cover" aria-label="Titelblatt">
            <div class="spine" aria-hidden="true"></div>
            <div class="elastic" aria-hidden="true"></div>
            <div class="ribbon" aria-hidden="true"></div>

            <div class="gilt-frame">
                <h2 class="foil">Freundebuch</h2>
                <p class="subtitle">Geschichten, Farben & Lieblingsmomente</p>
                <span class="chip">Zum Bl√§ttern klicken oder Pfeiltasten nutzen</span>
            </div>

            <!-- kleine Sticker/Doodles -->
            <div class="stickers" aria-hidden="true">
                <!-- Herz -->
                <div class="sticker heart">
                    <svg width="70" height="70" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" role="img">
                        <path d="M32 56s-9.7-6.7-16.3-13.3C8.2 35.2 6 30 6 24.8 6 18 11.3 12 18.4 12c4.5 0 8.3 2.3 10.6 5.7C31.3 14.3 35.1 12 39.6 12 46.7 12 52 18 52 24.8c0 5.2-2.2 10.4-9.7 17.9C41.7 49.3 32 56 32 56z" fill="#ef4444" stroke="white" stroke-width="3" />
                    </svg>
                </div>
                <!-- Stern -->
                <div class="sticker star">
                    <svg width="68" height="68" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" role="img">
                        <path d="M32 5l7.8 15.8 17.5 2.5-12.6 12.3 3 17.4L32 45.6 16.3 53l3-17.4L6.7 23.3l17.5-2.5L32 5z" fill="#f59e0b" stroke="white" stroke-width="3"/>
                    </svg>
                </div>
                <!-- Bleistift -->
                <div class="sticker pencil">
                    <svg width="120" height="32" viewBox="0 0 240 64" fill="none" xmlns="http://www.w3.org/2000/svg" role="img">
                        <rect x="20" y="20" width="170" height="24" rx="6" fill="#fbbf24" stroke="white" stroke-width="3"/>
                        <rect x="190" y="20" width="20" height="24" rx="4" fill="#9ca3af" stroke="white" stroke-width="3"/>
                        <polygon points="210,20 234,32 210,44" fill="#fb7185" stroke="white" stroke-width="3"/>
                    </svg>
                </div>
            </div>
        </div>

        <!-- Seiten werden dynamisch eingef√ºgt -->
        <div class="back">
            <div style="text-align:center;">
                <div class="kicker">Ende</div>
                Danke f√ºrs Reinschauen üëã
            </div>
        </div>

        <!-- Klick-Zonen -->
        <div class="hotspot left"  id="hotLeft"  aria-label="Zur√ºck bl√§ttern"></div>
        <div class="hotspot right" id="hotRight" aria-label="Weiter bl√§ttern"></div>
    </div>

    <div class="controls">
        <button class="btn" id="prevBtn">‚Üê Zur√ºck</button>
        <button class="btn" id="nextBtn">Weiter ‚Üí</button>
    </div>
    <div class="hint">Tipp: Klicke links/rechts ins Buch oder nutze die Pfeiltasten</div>
</div>

<script>
    const el=(t,a={},h='')=>{const n=document.createElement(t);Object.entries(a).forEach(([k,v])=>n.setAttribute(k,v));if(h)n.innerHTML=h;return n;}
    const fmtDate=iso=>{if(!iso)return'';const [y,m,d]=iso.split('-');return `${d}.${m}.${y}`}

    const book=document.getElementById('book');
    const prevBtn=document.getElementById('prevBtn');
    const nextBtn=document.getElementById('nextBtn');
    const hotLeft=document.getElementById('hotLeft');
    const hotRight=document.getElementById('hotRight');
    const cover=document.getElementById('cover');

    let pages=[];let pageIndex=-1; // -1 = Cover

    function setState(){
  const coverVisible = (pageIndex < 0);
  cover.style.display = coverVisible ? 'flex' : 'none';

  pages.forEach((p, i) => {
    p.style.display = coverVisible ? 'none' : 'block';   // <<< NEU
    p.classList.toggle('active', i === pageIndex);
    p.classList.toggle('flipped', i < pageIndex);
  });

  prevBtn.disabled = (pageIndex < 0);
  nextBtn.disabled = (pageIndex >= pages.length);
  hotLeft.style.pointerEvents  = prevBtn.disabled ? 'none' : 'auto';
  hotRight.style.pointerEvents = nextBtn.disabled ? 'none' : 'auto';
}

    function goNext(){ if(pageIndex<pages.length){ pageIndex++; setState(); } }
    function goPrev(){ if(pageIndex>=0){ pageIndex--; setState(); } }

    prevBtn.addEventListener('click',goPrev);
    nextBtn.addEventListener('click',goNext);
    hotLeft.addEventListener('click',goPrev);
    hotRight.addEventListener('click',goNext);
    window.addEventListener('keydown',e=>{ if(e.key==='ArrowRight')goNext(); if(e.key==='ArrowLeft')goPrev(); });

    function makePage(person){
      const html=`
        <div class="kicker">Profil</div>
        <h2 class="title">${person.name ?? ''}</h2>
        <div class="grid">
          <div><div class="label">Alter</div><div class="value">${person.age ?? ''}</div></div>
          <div><div class="label">Geburtsdatum</div><div class="value">${fmtDate(person.geburtsdatum)}</div></div>
          <div><div class="label">Lieblingsfarbe</div><div class="value">${person.favoriteColor ?? ''}</div></div>
          <div><div class="label">Hobby</div><div class="value">${person.hobby ?? ''}</div></div>
          <div><div class="label">Lieblingsessen</div><div class="value">${person.favoriteFood ?? ''}</div></div>
          <div><div class="label">Traumberuf</div><div class="value">${person.dreamJob ?? ''}</div></div>
        </div>
        <div class="footer">Seite</div>
      `;
      const p=el('section',{class:'page'},html);
      p.style.zIndex=1000-pages.length;
      return p;
    }

    // Daten holen und Seiten erzeugen
    fetch('/seite')
      .then(r=>{ if(!r.ok) throw new Error('HTTP '+r.status); return r.json(); })
      .then(list=>{
        if(!Array.isArray(list)) list=[list];
        if(list.length===0) list=[{name:'‚Äì',age:'‚Äì'}];
        list.forEach(person=>{ const page=makePage(person); book.appendChild(page); pages.push(page); });
        pageIndex=-1; setState();
      })
      .catch(err=>{
        const page=el('section',{class:'page active'},`<h2 class="title">Fehler</h2><p>${err.message}</p>`);
        book.appendChild(page); pages=[page]; pageIndex=0; setState();
      });
</script>
</body>
</html>
